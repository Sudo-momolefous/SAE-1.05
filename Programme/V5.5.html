<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8">
<title>dashboard securite reseau</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body {
    margin: 0;
    font-family: "Segoe UI", Arial;
    background: #0f172a;
    color: #e5e7eb;
}

header {
    background: #020617;
    padding: 20px;
    text-align: center;
    font-size: 24px;
    font-weight: bold;
}

.controls {
    background: #020617;
    margin: 20px;
    padding: 15px;
    border-radius: 12px;
    text-align: center;
}

.controls select, .controls button {
    padding: 8px 12px;
    border-radius: 6px;
    border: none;
    margin: 5px;
    font-size: 14px;
}

.dashboard {
    padding: 20px;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(420px, 1fr));
    gap: 20px;
}

.card {
    background: #020617;
    border-radius: 14px;
    padding: 20px;
}

.card h3 {
    margin-top: 0;
    margin-bottom: 15px;
    font-size: 18px;
    border-bottom: 1px solid #1e293b;
    padding-bottom: 8px;
}

.alert {
    background: #7f1d1d;
    padding: 10px;
    border-radius: 8px;
    margin-bottom: 8px;
}
</style>
</head>

<body>

<header>
dashboard de detection des attaques reseau
</header>

<div class="controls">
<label>type de graphique</label>
<select id="chartType">
    <option value="bar">diagramme en barres</option>
    <option value="pie">camembert</option>
</select>
<button onclick="drawAll()">mettre a jour</button>
</div>

<div class="dashboard">

<!-- bloc ip source -->
<div class="card">
<h3>ip source les plus actives</h3>
<canvas id="srcChart"></canvas>
</div>

<!-- bloc ip destination -->
<div class="card">
<h3>ip destination les plus sollicitees</h3>
<canvas id="dstChart"></canvas>
</div>

<!-- bloc camembert global -->
<div class="card">
<h3>repartition globale du trafic (ip source)</h3>
<canvas id="pieChart"></canvas>
</div>

<!-- bloc temporel -->
<div class="card">
<h3>activite reseau par heure</h3>
<canvas id="timeChart"></canvas>
</div>

<!-- bloc alertes -->
<div class="card">
<h3>alertes de securite</h3>
<div id="alerts"></div>
</div>

</div>

<script>
/* ===========================
   données injectées par python
   =========================== */
const srcData = SRC_DATA
const dstData = DST_DATA
const timeData = TIME_DATA
const alertsData = ALERTS_DATA

let charts = []

function createChart(canvasId, type, labels, data) {
    return new Chart(document.getElementById(canvasId), {
        type: type,
        data: {
            labels: labels,
            datasets: [{
                data: data
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    display: type === "pie"
                }
            }
        }
    })
}

function drawAll() {
    const type = document.getElementById("chartType").value

    charts.forEach(c => c.destroy())
    charts = []

    charts.push(createChart(
        "srcChart",
        type,
        Object.keys(srcData),
        Object.values(srcData)
    ))

    charts.push(createChart(
        "dstChart",
        type,
        Object.keys(dstData),
        Object.values(dstData)
    ))

    charts.push(createChart(
        "pieChart",
        "pie",
        Object.keys(srcData),
        Object.values(srcData)
    ))

    charts.push(createChart(
        "timeChart",
        "line",
        Object.keys(timeData),
        Object.values(timeData)
    ))
}

function afficherAlertes() {
    const div = document.getElementById("alerts")
    div.innerHTML = ""

    if (alertsData.length === 0) {
        div.innerHTML = "<div class='alert'>aucune menace evidente detectee</div>"
        return
    }

    alertsData.forEach(a => {
        const d = document.createElement("div")
        d.className = "alert"
        d.textContent = a
        div.appendChild(d)
    })
}

drawAll()
afficherAlertes()
</script>

</body>
</html>
